il.MultiLineNewInputGUI={add:function(a,b){var c=this.clone_template[a].clone();this.init(a,c),b.after(c),this.update(a,b.parent())},addFirstLine:function(a){this.add_first_line[a].hide();var b=this.clone_template[a].clone();this.init(a,b),this.add_first_line[a].parent().parent().children().eq(1).append(b),this.update(a,this.add_first_line[a].parent().parent().children().eq(1))},add_first_line:{},cached_options:[],cacheOptions(a,b,c,d){Array.isArray(this.cached_options[a])||(this.cached_options[a]=[]),this.cached_options[a].push({type:c,options:d}),b.attr("data-cached_options_id",this.cached_options[a].length-1)},clone_template:{},down:function(a,b){b.insertAfter(b.next()),this.update(a,b.parent())},init:function(a,b,c){$("span[data-action]",b).each(function(c,d){d=$(d),d.off(),d.on("click",this[d.data("action")].bind(this,a,b))}.bind(this)),c?this.add_first_line[a]=b:($(".input-group.date:not([data-cached_options_id])",b).each(function(b,c){c=$(c),c.data("DateTimePicker")&&this.cacheOptions(a,c,"datetimepicker",c.datetimepicker("options"))}.bind(this)),$("select[data-multiselectsearchnewinputgui]:not([data-cached_options_id])",b).each(function(b,c){c=$(c);const d=JSON.parse(atob(c.data("multiselectsearchnewinputgui")));this.cacheOptions(a,c,"select2",d)}.bind(this)),!this.clone_template[a]&&(this.clone_template[a]=b.clone(),$("[name]",this.clone_template[a]).each(function(a,b){"checkbox"===b.type?b.checked=!1:b.value=""}),$(".alert",this.clone_template[a]).remove(),this.clone_template[a].show(),$("select[data-multiselectsearchnewinputgui]",this.clone_template[a]).each(function(a,b){b=$(b),b.html("")}.bind(this)),b.parent().parent().data("remove_first_line")&&this.remove(a,b)))},remove:function(a,b){var c=b.parent();(!c.parent().data("required")||1<c.children().length)&&(b.remove(),this.update(a,c))},up:function(a,b){b.insertBefore(b.prev()),this.update(a,b.parent())},update:function(a,b){$("span[data-action=up]",b).show(),$("> div:first-of-type span[data-action=up]",b).hide(),$("span[data-action=down]",b).show(),$("> div:last-of-type span[data-action=down]",b).hide();for(const c of["aria-controls","aria-labelledby","href","id","name"])b.children().each(function(a,b){$("["+c+"]",b).each(function(b,d){for(const[e,f]of[["[","]["],["__","__"]])d.attributes[c].value=d.attributes[c].value.replace(new RegExp(e.replace(/./g,"\\$&")+"[0-9]+"+f.replace(/./g,"\\$&")),e+a+f)}.bind(this))}.bind(this));b.parent().data("required")?2>b.children().length?$("span[data-action=remove]",b).hide():$("span[data-action=remove]",b).show():($("span[data-action=remove]",b).show(),0===b.children().length&&this.add_first_line[a].show()),$("[data-cached_options_id]",b).each(function(b,c){c=$(c);const d=this.cached_options[a][c.attr("data-cached_options_id")];if(d)switch(d.type){case"datetimepicker":c.data("DateTimePicker")&&c.datetimepicker("destroy"),c.prop("id",""),c.datetimepicker(d.options);break;case"select2":c.data("select2")&&c.select2("destroy"),c.next(".select2").remove(),c.removeAttr("class"),c.removeAttr("data-select2-id"),c.removeAttr("aria-hidden"),c.removeAttr("tabindex"),c.select2(d.options);break;default:}}.bind(this))}};
